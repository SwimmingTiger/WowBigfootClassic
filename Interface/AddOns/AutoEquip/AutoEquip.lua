 local AUTOEQUIP_NAME local AUTOEQUIP_SAVE_INFO,AUTOEQUIP_DEL_INFO,AUTOEQUIP_SAVE_FINFO,AUTOEQUIP_ERROR_INFO,AUTOEQUIP_DEL_TEXT,AUTOEQUIP_TEXT_SAVED local AUTOEQUIP_TEXT_RENAME,AUTOEQUIP_HELP_SAVE_BTN_TITLE,AUTOEQUIP_HELP_SAVE_BTN_DESC,AUTOEQUIP_HELP_SET_BTN_COMMENT1,AUTOEQUIP_NEW_INFO local AUTOEQUIP_MOVE_TOOLTIP,AUTOEQUIP_TEXT_SWITCH,AUTOEQUIP_TEXT_SWITCH_LOSTSET,AUTOEQUIP_RAID_TIP,AUTOEQUIP_TEXT_SWITCH_InCombat local AUTOEQUIP_HELP_SET_DROPDOWN_COMMENT,M_REPAIR_COST local _ if ( GetLocale() == "zhCN" ) then AUTOEQUIP_NAME = "自动换装"; BINDING_HEADER_AUTOEQUIP_TITLE = "自动换装按键"; BINDING_NAME_AUTOEQUIP_SET1 = "套装 1"; BINDING_NAME_AUTOEQUIP_SET2 = "套装 2"; BINDING_NAME_AUTOEQUIP_SET3 = "套装 3"; BINDING_NAME_AUTOEQUIP_SET4 = "套装 4"; BINDING_NAME_AUTOEQUIP_SET5 = "套装 5"; BINDING_NAME_AUTOEQUIP_SET6 = "套装 6"; BINDING_NAME_AUTOEQUIP_SET7 = "套装 7"; BINDING_NAME_AUTOEQUIP_SET8 = "套装 8"; BINDING_NAME_AUTOEQUIP_NEXT = "切换到下一套装备"; BINDING_NAME_AUTOEQUIP_PREV = "切换到上一套装备"; AUTOEQUIP_SAVE_INFO = "执行该操作将覆盖方案 %s 以前的设置，您是否真的想这么做？"; AUTOEQUIP_DEL_INFO = "确定要删除此方案吗？"; AUTOEQUIP_SAVE_FINFO ="该方案未保存任何配置,是否新建一个装备方案？"; AUTOEQUIP_ERROR_INFO ="请检查是否与其他方案名称冲突！"; AUTOEQUIP_DEL_TEXT = "套装方案 %s 已删除"; AUTOEQUIP_TEXT_SAVED = "套装方案 %s 已保存"; AUTOEQUIP_TEXT_RENAME = "已将方案 %s 重命名为 %s "; AUTOEQUIP_HELP_SAVE_BTN_TITLE = "保存装备配置"; AUTOEQUIP_HELP_SAVE_BTN_DESC = "左键单击覆盖或添加套裝方案，右键单击卸除所有装备。"; AUTOEQUIP_NEW_INFO = "点击快捷新建一个套装方案"; AUTOEQUIP_HELP_SET_BTN_COMMENT1 = "左键单击切换到此方案"; AUTOEQUIP_HELP_SET_DROPDOWN_COMMENT = "右键调出详细菜单" AUTOEQUIP_MOVE_TOOLTIP = "按住Shift和鼠标左键可拖动框体。"; AUTOEQUIP_TEXT_SWITCH = "|cff00adef<自动换装>|r 当前装备的套装方案为 %s。"; AUTOEQUIP_TEXT_SWITCH_InCombat = "|cff00adef<自动换装>|r 战斗状态无法切换套装方案！"; AUTOEQUIP_TEXT_SWITCH_LOSTSET = "|cff00adef<自动换装>|r 无法完全切换到方案 %s。缺少%d件装备，请检查。"; AUTOEQUIP_RAID_TIP = "你现在处于团队中，自动换装界面自动隐藏。为了切换装备套装，请移动鼠标到自己头像上，界面将会显示。"; M_REPAIR_COST = "维修费用" elseif ( GetLocale() == "zhTW" ) then AUTOEQUIP_NAME = "自動換裝"; BINDING_HEADER_AUTOEQUIP_TITLE = "自動換裝按鍵"; BINDING_NAME_AUTOEQUIP_SET1 = "套裝 1"; BINDING_NAME_AUTOEQUIP_SET2 = "套裝 2"; BINDING_NAME_AUTOEQUIP_SET3 = "套裝 3"; BINDING_NAME_AUTOEQUIP_SET4 = "套裝 4"; BINDING_NAME_AUTOEQUIP_SET5 = "套裝 5"; BINDING_NAME_AUTOEQUIP_SET6 = "套裝 6"; BINDING_NAME_AUTOEQUIP_SET7 = "套裝 7"; BINDING_NAME_AUTOEQUIP_SET8 = "套裝 8"; BINDING_NAME_AUTOEQUIP_NEXT = "切換到下一套裝備"; BINDING_NAME_AUTOEQUIP_PREV = "切換到上一套裝備"; AUTOEQUIP_SAVE_INFO = "執行該操作將覆蓋方案 %s 以前的設置，您是否真的想這麼做？"; AUTOEQUIP_DEL_INFO = "確定要刪除此號方案嗎？"; AUTOEQUIP_SAVE_FINFO ="該方案未保存任何配置,是否新建一個裝備方案？"; AUTOEQUIP_ERROR_INFO ="請檢查是否與其他方案名稱衝突！"; AUTOEQUIP_DEL_TEXT = "套裝方案 %s 已刪除"; AUTOEQUIP_TEXT_SAVED = "套裝方案 %s 已保存"; AUTOEQUIP_TEXT_RENAME = "已將方案 %s 重命名為 %s "; AUTOEQUIP_HELP_SAVE_BTN_TITLE = "保存裝備配置"; AUTOEQUIP_HELP_SAVE_BTN_DESC = "左鍵單擊覆蓋或添加套装方案，右鍵單擊卸除所有裝備。"; AUTOEQUIP_NEW_INFO = "點擊快捷新建一個套裝方案"; AUTOEQUIP_HELP_SET_BTN_COMMENT1 = "左鍵單擊切換到此方案"; AUTOEQUIP_HELP_SET_DROPDOWN_COMMENT = "右鍵調出詳細菜單" AUTOEQUIP_MOVE_TOOLTIP = "按住Shift和滑鼠左鍵可拖動框體。"; AUTOEQUIP_TEXT_SWITCH = "|cff00adef<自動換裝>|r 當前裝備的套裝方案為 %s。"; AUTOEQUIP_TEXT_SWITCH_InCombat = "|cff00adef<自動換裝>|r 戰鬥狀態無法切換套裝方案！"; AUTOEQUIP_TEXT_SWITCH_LOSTSET = "|cff00adef<自動換裝>|r 無法完全切換到方案 %s。缺少%d件裝備，請檢查。"; AUTOEQUIP_RAID_TIP = "你現在處於團隊中，自動換裝介面自動隱藏。為了切換裝備套裝，請移動滑鼠到自己頭像上，介面將會顯示。"; M_REPAIR_COST = "維修費用" else AUTOEQUIP_NAME = "Auto Equip"; BINDING_HEADER_AUTOEQUIP_TITLE = "Auto Equip"; BINDING_NAME_AUTOEQUIP_SET1 = "Set 1"; BINDING_NAME_AUTOEQUIP_SET2 = "Set 2"; BINDING_NAME_AUTOEQUIP_SET3 = "Set 3"; BINDING_NAME_AUTOEQUIP_SET4 = "Set 4"; BINDING_NAME_AUTOEQUIP_SET5 = "Set 5"; BINDING_NAME_AUTOEQUIP_SET6 = "Set 6"; BINDING_NAME_AUTOEQUIP_SET7 = "Set 7"; BINDING_NAME_AUTOEQUIP_SET8 = "Set 8"; BINDING_NAME_AUTOEQUIP_NEXT = "Switch to next set"; BINDING_NAME_AUTOEQUIP_PREV = "Switch to previous set"; AUTOEQUIP_SAVE_INFO = "Settings %s will be replaced, do you really want to do?"; AUTOEQUIP_DEL_INFO = "Are you sure to delete this plan?"; AUTOEQUIP_SAVE_FINFO ="The scheme not save any configuration, whether a new equipment plan?"; AUTOEQUIP_ERROR_INFO ="Please check whether the name conflicts with other schemes!"; AUTOEQUIP_DEL_TEXT = "Suit scheme %s The deleted"; AUTOEQUIP_TEXT_SAVED = "Suit scheme %s Has preserved"; AUTOEQUIP_TEXT_RENAME = "Has suit scheme %s Renamed %s "; AUTOEQUIP_HELP_SAVE_BTN_TITLE = "Save settings"; AUTOEQUIP_HELP_SAVE_BTN_DESC = "Left-click on cover or add suit scheme, right-click the unloading all equipment."; AUTOEQUIP_NEW_INFO = "Click to create a new Set"; AUTOEQUIP_HELP_SET_BTN_COMMENT1 = "Left-click switching suit scheme"; AUTOEQUIP_HELP_SET_DROPDOWN_COMMENT = "Right-click call the detail drop down list" AUTOEQUIP_MOVE_TOOLTIP = "Hold shift key and Left button to drag frame."; AUTOEQUIP_TEXT_SWITCH = "|cff00adef<AutoEquip>|r Current equipped set: %s ."; AUTOEQUIP_TEXT_SWITCH_InCombat = "|cff00adef<AutoEquip>|r Can't change Set InCombat."; AUTOEQUIP_TEXT_SWITCH_LOSTSET = "|cff00adef<AutoEquip>|r Set %s Miss %d Equipment，Please Check."; AUTOEQUIP_RAID_TIP = "You are now in raid, the AutoEquip interface will be hide automatically. To switch your equipment set, move your mouse on your portrait, the interface will be shown."; M_REPAIR_COST = "Repair Cost" end local AutoEquip_a4ed2c6153d1a73ae298b67f0bcbabce = BLibrary("BInfo", "chat", AUTOEQUIP_NAME); local AutoEquip_b5afb1939b42d2489f5d7985e2839133 = { 16, 17, 5, 7, 1, 3, 8, 10, 9, 6, 2, 15, 11, 12, 13, 14, 4, 19, }; local AutoEquip_6781199f633c5d9ede0aa8c0a5a346d0,AutoEquip_352a74c60685e01427cbef1c647d5199,AutoEquip_642022feafc2fd091c1bc9b53b20e8d1; local AutoEquip_500a8ad122d34cab3e445c13c86044e5; local function MoveIcons() PlayerLeaderIcon:ClearAllPoints(); PlayerLeaderIcon:SetPoint("TOPLEFT", "PlayerFrame", "TOPLEFT", 55, -12); end local function ResetIcons() PlayerLeaderIcon:ClearAllPoints(); PlayerLeaderIcon:SetPoint("TOPLEFT", "PlayerFrame", "TOPLEFT", 40, -12); end function AutoEquipFrame_OnMouseDown(self) if (AutoEquip_352a74c60685e01427cbef1c647d5199 and IsShiftKeyDown()) then self:StartMoving(); self.moving = true; end end function AutoEquipFrame_OnMouseUp(self) if (self.moving) then self:StopMovingOrSizing(); self.moving = false; end end function AutoEquipFrame_OnEnter(self) AutoEquipFrameBackground:SetTexCoord(unpack(AutoEquipFrameBackground.hilight_coords)); GameTooltip:SetOwner(self, "ANCHOR_BOTTOM",0,-50); GameTooltip:SetText(AUTOEQUIP_NAME, 1.0, 1.0, 1.0); GameTooltip:AddLine(AUTOEQUIP_MOVE_TOOLTIP, NORMAL_FONT_COLOR.r, NORMAL_FONT_COLOR.g, NORMAL_FONT_COLOR.b, 1.0, 1); GameTooltip:Show(); end function AutoEquipFrame_OnLeave(self) AutoEquipFrameBackground:SetTexCoord(unpack(AutoEquipFrameBackground.normal_coords)); GameTooltip:Hide(); end local function AutoEquip_PlayerFrame_OnEnter() if (AutoEquip_6781199f633c5d9ede0aa8c0a5a346d0 and not AutoEquipFrame:IsShown()) then AutoEquipFrame:Show(); end end local function AutoEquip_PlayerFrame_OnUpdate() if (AutoEquip_6781199f633c5d9ede0aa8c0a5a346d0 and AutoEquip_642022feafc2fd091c1bc9b53b20e8d1) then if (AutoEquipFrame:IsVisible() and PlayerFrameGroupIndicator:IsVisible()) then local AutoEquip_7242cf1b41caa7510cf530297a011730, AutoEquip_cf709faa4d1d5a25a70ffb7820ac3c77 = GetCursorPosition(); if ( AutoEquip_cf709faa4d1d5a25a70ffb7820ac3c77 < 600) then AutoEquipFrame:Hide(); end end end end local function AutoEquip_c990e192b1d042b676a4ee0ffff5d729() if (AutoEquip_6781199f633c5d9ede0aa8c0a5a346d0 and AutoEquip_642022feafc2fd091c1bc9b53b20e8d1) then if not IsInRaid() then AutoEquipFrame:Show(); else if AutoEquipFrame:IsShown() then AutoEquipFrame:Hide(); AutoEquip_a4ed2c6153d1a73ae298b67f0bcbabce:Print(AUTOEQUIP_RAID_TIP); end end end end function AutoEquipFrame_OnLoad(self) hooksecurefunc("PlayerFrame_UpdateGroupIndicator", AutoEquip_c990e192b1d042b676a4ee0ffff5d729); PlayerFrame:HookScript("OnEnter", AutoEquip_PlayerFrame_OnEnter); PlayerFrame:HookScript("OnUpdate", AutoEquip_PlayerFrame_OnUpdate); self:RegisterEvent("ADDON_LOADED"); self:RegisterEvent("EQUIPMENT_SETS_CHANGED"); self:RegisterEvent("PLAYER_EQUIPMENT_CHANGED"); for AutoEquip_e914904fab9d05d3f54d52bfc31a0f3f = 1, 8, 1 do local AutoEquip_99f3cf2c6f1fdfadb0fd4ab6e0843bf5 = _G["AutoEquipSetButton"..AutoEquip_e914904fab9d05d3f54d52bfc31a0f3f]; local AutoEquip_5b142532ca616f4ae4690d782a43675e = _G["AutoEquipSetButton"..(AutoEquip_e914904fab9d05d3f54d52bfc31a0f3f - 1)]; AutoEquip_99f3cf2c6f1fdfadb0fd4ab6e0843bf5:GetNormalTexture():SetTexCoord(0 + (AutoEquip_e914904fab9d05d3f54d52bfc31a0f3f - 1) * 0.07421875, 0.07421875 + (AutoEquip_e914904fab9d05d3f54d52bfc31a0f3f - 1) * 0.07421875, 0.6484375, 0.78125); AutoEquip_99f3cf2c6f1fdfadb0fd4ab6e0843bf5:GetPushedTexture():SetTexCoord(0 + (AutoEquip_e914904fab9d05d3f54d52bfc31a0f3f - 1) * 0.07421875, 0.07421875 + (AutoEquip_e914904fab9d05d3f54d52bfc31a0f3f - 1) * 0.07421875, 0.7890625, 0.921875); if AutoEquip_e914904fab9d05d3f54d52bfc31a0f3f == 1 then AutoEquip_99f3cf2c6f1fdfadb0fd4ab6e0843bf5:SetPoint("LEFT", AutoEquipSaveButton, "RIGHT", 3, 0); elseif AutoEquip_5b142532ca616f4ae4690d782a43675e then AutoEquip_99f3cf2c6f1fdfadb0fd4ab6e0843bf5:SetPoint("LEFT", AutoEquip_5b142532ca616f4ae4690d782a43675e, "RIGHT", 3, 0); end end end local function AutoEquip_76c6488cc84b5b8179cfa77d4fd56eaa(AutoEquip_8d0febf2348ea712b2b375ae95601d5f) local AutoEquip_3decdcd698c5cf72604c8703b513eb41 = C_EquipmentSet.GetEquipmentSetIDs(); return AutoEquip_3decdcd698c5cf72604c8703b513eb41[AutoEquip_8d0febf2348ea712b2b375ae95601d5f]; end local function AutoEquip_4028c7da12ff52455abb865b298ff7e2(AutoEquip_8d0febf2348ea712b2b375ae95601d5f) local AutoEquip_ff1b4022732c44ba86eae6bf2228a25a = AutoEquip_76c6488cc84b5b8179cfa77d4fd56eaa(AutoEquip_8d0febf2348ea712b2b375ae95601d5f); if AutoEquip_ff1b4022732c44ba86eae6bf2228a25a then return C_EquipmentSet.GetEquipmentSetInfo(AutoEquip_ff1b4022732c44ba86eae6bf2228a25a); end end local function AutoEquip_7fa14bf1c4f9fdb64a455dfd719908d8() for i = 1, 8 do _G["AutoEquipSetButton"..i]:SetChecked(false); end local isEquipped; local AutoEquip_3decdcd698c5cf72604c8703b513eb41 = C_EquipmentSet.GetEquipmentSetIDs(); local num = #AutoEquip_3decdcd698c5cf72604c8703b513eb41; num = num > 8 and 8 or num; for index = 1, num do _a,_b,_c,isEquipped = C_EquipmentSet.GetEquipmentSetInfo(AutoEquip_3decdcd698c5cf72604c8703b513eb41[index]); if isEquipped then _G["AutoEquipSetButton"..index]:SetChecked(true); end if not AutoEquip_500a8ad122d34cab3e445c13c86044e5 and (GearManagerDialog.selectedSet and GearManagerDialog.selectedSet.id == AutoEquip_3decdcd698c5cf72604c8703b513eb41[index]) then AutoEquip_500a8ad122d34cab3e445c13c86044e5 = index; end end end local function AutoEquip_edde6b9defd14002a775b763b5f565e3(AutoEquip_8d0febf2348ea712b2b375ae95601d5f) if not InCombatLockdown() then local setName,_,_,_,_,_,_,numLost = AutoEquip_4028c7da12ff52455abb865b298ff7e2(AutoEquip_8d0febf2348ea712b2b375ae95601d5f) if setName then local AutoEquip_ff1b4022732c44ba86eae6bf2228a25a = AutoEquip_76c6488cc84b5b8179cfa77d4fd56eaa(AutoEquip_8d0febf2348ea712b2b375ae95601d5f); EquipmentManager_EquipSet(AutoEquip_ff1b4022732c44ba86eae6bf2228a25a) local str; if numLost == 0 then str = string.format(AUTOEQUIP_TEXT_SWITCH, setName); else str = string.format(AUTOEQUIP_TEXT_SWITCH_LOSTSET, setName,numLost); end BigFoot_Report("info", str); PlaySound(SOUNDKIT.IG_CHARACTER_INFO_OPEN); end else BigFoot_Report("info", AUTOEQUIP_TEXT_SWITCH_InCombat); end AutoEquip_7fa14bf1c4f9fdb64a455dfd719908d8(); end local function AutoEquip_bf737188f1f5a0018780565eaf91afc0(AutoEquip_8d0febf2348ea712b2b375ae95601d5f) local AutoEquip_ff1b4022732c44ba86eae6bf2228a25a = AutoEquip_76c6488cc84b5b8179cfa77d4fd56eaa(AutoEquip_8d0febf2348ea712b2b375ae95601d5f); if AutoEquip_ff1b4022732c44ba86eae6bf2228a25a then local AutoEquip_34123c02f75da83a2df856cf83cac9c1 = AutoEquip_4028c7da12ff52455abb865b298ff7e2(AutoEquip_8d0febf2348ea712b2b375ae95601d5f); C_EquipmentSet.DeleteEquipmentSet(AutoEquip_ff1b4022732c44ba86eae6bf2228a25a); local str = string.format(AUTOEQUIP_DEL_TEXT, AutoEquip_34123c02f75da83a2df856cf83cac9c1); BigFoot_Report("info", str); end end local function AutoEquip_224246a2aec3ecad61ed8d03e82f9cb2(AutoEquip_34123c02f75da83a2df856cf83cac9c1,AutoEquip_ff1b4022732c44ba86eae6bf2228a25a) if AutoEquip_ff1b4022732c44ba86eae6bf2228a25a then C_EquipmentSet.SaveEquipmentSet(AutoEquip_34123c02f75da83a2df856cf83cac9c1); else C_EquipmentSet.CreateEquipmentSet(AutoEquip_34123c02f75da83a2df856cf83cac9c1); end local str = string.format(AUTOEQUIP_TEXT_SAVED, AutoEquip_34123c02f75da83a2df856cf83cac9c1); BigFoot_Report("info", str); end local function AutoEquip_5eb24152420f2e356247c122dfb5cdbc(AutoEquip_ff1b4022732c44ba86eae6bf2228a25a,AutoEquip_1d3e52f32b5592fd24f689bf25fef888) StaticPopupDialogs["SAVE_SET"].switch = nil; if C_EquipmentSet.GetEquipmentSetID(AutoEquip_1d3e52f32b5592fd24f689bf25fef888) then BigFoot_Report("info", AUTOEQUIP_ERROR_INFO); return; end local AutoEquip_8d0febf2348ea712b2b375ae95601d5f = AutoEquip_76c6488cc84b5b8179cfa77d4fd56eaa(AutoEquip_ff1b4022732c44ba86eae6bf2228a25a); if AutoEquip_8d0febf2348ea712b2b375ae95601d5f then local AutoEquip_34123c02f75da83a2df856cf83cac9c1 = AutoEquip_4028c7da12ff52455abb865b298ff7e2(AutoEquip_ff1b4022732c44ba86eae6bf2228a25a); C_EquipmentSet.ModifyEquipmentSet(AutoEquip_8d0febf2348ea712b2b375ae95601d5f,AutoEquip_1d3e52f32b5592fd24f689bf25fef888); local str = string.format(AUTOEQUIP_TEXT_RENAME, AutoEquip_34123c02f75da83a2df856cf83cac9c1,AutoEquip_1d3e52f32b5592fd24f689bf25fef888); BigFoot_Report("info", str); end end local function IsEquippableSlot(slot) return not InCombatLockdown() or (slot == 16 or slot == 17) end local function GetAvailableBags() local bags = {} for i = 0, 4 do local slots, family = GetContainerNumFreeSlots(i) bags[i] = (family == 0) and slots or 0 end return bags end local function GetFirstAvailableBag(bags) for i = 0, 4 do if bags[i] > 0 then return i end end end local function StripOff() local bags = GetAvailableBags() for i,v in pairs(AutoEquip_b5afb1939b42d2489f5d7985e2839133) do local lnk = GetInventoryItemLink("player", v) if lnk and IsEquippableSlot(v) then local bag = GetFirstAvailableBag(bags) if bag then PickupInventoryItem(v) if CursorHasItem() then if bag == 0 then PutItemInBackpack() else PutItemInBag(19 + bag) end end bags[bag] = bags[bag] - 1 else BigFoot_Report("info", ERR_INV_FULL); return; end end end end function AutoEquipSaveButton_OnClick(self, button) if ( button and button == "RightButton" ) then StripOff(); else if AutoEquip_500a8ad122d34cab3e445c13c86044e5 then local setName = AutoEquip_4028c7da12ff52455abb865b298ff7e2(AutoEquip_500a8ad122d34cab3e445c13c86044e5) if setName then StaticPopup_Show("SAVE_RESAVE", setName) else StaticPopup_Show("SAVE_SET"); end else StaticPopup_Show("SAVE_SET"); end end end function AutoEquipSetButton_OnClick(self, __index, AutoEquip_99f3cf2c6f1fdfadb0fd4ab6e0843bf5) if CursorHasItem() then return end AutoEquip_500a8ad122d34cab3e445c13c86044e5 = __index; local AutoEquip_34123c02f75da83a2df856cf83cac9c1 = AutoEquip_4028c7da12ff52455abb865b298ff7e2(__index); if not AutoEquip_34123c02f75da83a2df856cf83cac9c1 then StaticPopup_Show("SAVE_FSET"); return; end if (AutoEquip_99f3cf2c6f1fdfadb0fd4ab6e0843bf5 and AutoEquip_99f3cf2c6f1fdfadb0fd4ab6e0843bf5 == "RightButton") then ToggleDropDownMenu(nil, nil, bf_AeDropDownMenu, AutoEquipFrame, 32, 10); else AutoEquip_edde6b9defd14002a775b763b5f565e3(__index); end end function AutoEquipFrame_OnEvent(self, AutoEquip_d0708241b607c9a9dd1953c812fadfb7, ...) if AutoEquip_d0708241b607c9a9dd1953c812fadfb7 == "ADDON_LOADED" then local AutoEquip_1652701c940a7445a6e43b954d36ec9b = ...; if AutoEquip_1652701c940a7445a6e43b954d36ec9b == "AutoEquip" then self:UnregisterEvent("ADDON_LOADED"); AutoEquip_7fa14bf1c4f9fdb64a455dfd719908d8(); end return; end AutoEquip_7fa14bf1c4f9fdb64a455dfd719908d8(); end function AutoEquip_SwitchToNext() local AutoEquip_3decdcd698c5cf72604c8703b513eb41 = C_EquipmentSet.GetEquipmentSetIDs(); local num = #AutoEquip_3decdcd698c5cf72604c8703b513eb41; num = num > 8 and 8 or num; if num < 1 then return end if not AutoEquip_500a8ad122d34cab3e445c13c86044e5 then AutoEquipSetButton_OnClick(nil, 1); return; end local AutoEquip_8f81cccca434aa7ae8e147d0fcfb685f; for i = 1, num do if i == AutoEquip_500a8ad122d34cab3e445c13c86044e5 then AutoEquip_8f81cccca434aa7ae8e147d0fcfb685f = i + 1; break; end end if ( not AutoEquip_8f81cccca434aa7ae8e147d0fcfb685f or AutoEquip_8f81cccca434aa7ae8e147d0fcfb685f > num ) then AutoEquip_8f81cccca434aa7ae8e147d0fcfb685f = 1; end AutoEquipSetButton_OnClick(nil, AutoEquip_8f81cccca434aa7ae8e147d0fcfb685f); end function AutoEquip_SwitchToPrev() local AutoEquip_3decdcd698c5cf72604c8703b513eb41 = C_EquipmentSet.GetEquipmentSetIDs(); local num = #AutoEquip_3decdcd698c5cf72604c8703b513eb41; num = num > 8 and 8 or num; if num < 1 then return end if not AutoEquip_500a8ad122d34cab3e445c13c86044e5 then AutoEquipSetButton_OnClick(nil, 1); return; end local AutoEquip_8f81cccca434aa7ae8e147d0fcfb685f; for i = 1, num do if i == AutoEquip_500a8ad122d34cab3e445c13c86044e5 then AutoEquip_8f81cccca434aa7ae8e147d0fcfb685f = i - 1; break; end end if ( not AutoEquip_8f81cccca434aa7ae8e147d0fcfb685f or AutoEquip_8f81cccca434aa7ae8e147d0fcfb685f < 1 ) then AutoEquip_8f81cccca434aa7ae8e147d0fcfb685f = num; end AutoEquipSetButton_OnClick(nil, AutoEquip_8f81cccca434aa7ae8e147d0fcfb685f); end function AutoEquipSaveButton_OnEnter(self) GameTooltip:SetOwner(self, "ANCHOR_BOTTOMRIGHT",-50,-50); GameTooltip:SetText(AUTOEQUIP_HELP_SAVE_BTN_TITLE, 1.0, 1.0, 1.0); GameTooltip:AddLine(AUTOEQUIP_HELP_SAVE_BTN_DESC, NORMAL_FONT_COLOR.r, NORMAL_FONT_COLOR.g, NORMAL_FONT_COLOR.b, 1.0, 1); GameTooltip:Show(); end function AutoEquipSetButton_OnEnter(self, AutoEquip_8d0febf2348ea712b2b375ae95601d5f) GameTooltip:SetOwner(self, "ANCHOR_BOTTOMRIGHT",-50,-50); local AutoEquip_34123c02f75da83a2df856cf83cac9c1 = AutoEquip_4028c7da12ff52455abb865b298ff7e2(AutoEquip_8d0febf2348ea712b2b375ae95601d5f); if AutoEquip_34123c02f75da83a2df856cf83cac9c1 then GameTooltip:SetText(AutoEquip_34123c02f75da83a2df856cf83cac9c1, 1.0, 1.0, 1.0); GameTooltip:AddLine(AUTOEQUIP_HELP_SET_BTN_COMMENT1, NORMAL_FONT_COLOR.r, NORMAL_FONT_COLOR.g, NORMAL_FONT_COLOR.b, 1.0, 1); GameTooltip:AddLine(AUTOEQUIP_HELP_SET_DROPDOWN_COMMENT, NORMAL_FONT_COLOR.r, NORMAL_FONT_COLOR.g, NORMAL_FONT_COLOR.b, 1.0, 1); else GameTooltip:SetText(PAPERDOLL_NEWEQUIPMENTSET, 1.0, 1.0, 1.0); GameTooltip:AddLine(AUTOEQUIP_NEW_INFO, NORMAL_FONT_COLOR.r, NORMAL_FONT_COLOR.g, NORMAL_FONT_COLOR.b, 1.0, 1); end GameTooltip:Show(); end local function DropDownMenu_DeleteSet() StaticPopup_Show("DELETE_SET"); end local function DropDownMenu_RenameSet() ToggleCharacter("PaperDollFrame",true); --[[ PaperDollFrame_SetSidebar(PaperDollSidebarTab3,PaperDollSidebarTab3:GetID()); GearSetEditButton_OnClick(_G["PaperDollEquipmentManagerPaneButton"..AutoEquip_500a8ad122d34cab3e445c13c86044e5.."EditButton"]) ]] GearManagerDialog:Show(); end function bf_AeDropDownMenu_OnLoad() info = {}; info.text = "删除该方案"; info.notCheckable = true info.func = DropDownMenu_DeleteSet; UIDropDownMenu_AddButton(info); info.text = "设置该方案"; info.notCheckable = true info.func = DropDownMenu_RenameSet; UIDropDownMenu_AddButton(info); end StaticPopupDialogs["DELETE_SET"] = { text = AUTOEQUIP_DEL_INFO, button1 = YES, button2 = NO, OnAccept = function(self) AutoEquip_bf737188f1f5a0018780565eaf91afc0(AutoEquip_500a8ad122d34cab3e445c13c86044e5) end, OnCancel = function(self) AutoEquip_7fa14bf1c4f9fdb64a455dfd719908d8(); end, showAlert = 1, timeout = 0, }; StaticPopupDialogs["SAVE_SET"] = { text = GEARSETS_POPUP_TEXT, button1 = ACCEPT, button2 = CANCEL, hasEditBox = 1, maxLetters = 16, OnAccept = function(self) local editBox = _G[self:GetName().."EditBox"]; if StaticPopupDialogs["SAVE_SET"].switch then AutoEquip_5eb24152420f2e356247c122dfb5cdbc(AutoEquip_500a8ad122d34cab3e445c13c86044e5,editBox:GetText()); else AutoEquip_224246a2aec3ecad61ed8d03e82f9cb2(editBox:GetText()); end end, OnShow = function(self) local AutoEquip_34123c02f75da83a2df856cf83cac9c1 = AutoEquip_4028c7da12ff52455abb865b298ff7e2(AutoEquip_500a8ad122d34cab3e445c13c86044e5); if AutoEquip_34123c02f75da83a2df856cf83cac9c1 then _G[self:GetName().."EditBox"]:SetText(AutoEquip_34123c02f75da83a2df856cf83cac9c1); _G[self:GetName().."EditBox"]:HighlightText(); end end, OnHide = function(self) _G[self:GetName().."EditBox"]:SetText(""); end, OnCancel = function(self) AutoEquip_7fa14bf1c4f9fdb64a455dfd719908d8(); end, EditBoxOnEnterPressed = function(self) local editBox = _G[self:GetName()]; if StaticPopupDialogs["SAVE_SET"].switch then AutoEquip_5eb24152420f2e356247c122dfb5cdbc(AutoEquip_500a8ad122d34cab3e445c13c86044e5,editBox:GetText()); else AutoEquip_224246a2aec3ecad61ed8d03e82f9cb2(editBox:GetText()); end self:GetParent():Hide(); end, EditBoxOnEscapePressed = function(self) self:GetParent():Hide(); end, timeout = 0, exclusive = 1, whileDead = 1, hideOnEscape = 1 }; StaticPopupDialogs["SAVE_FSET"] = { text = AUTOEQUIP_SAVE_FINFO, button1 = YES, button2 = NO, OnAccept = function(self) StaticPopup_Show("SAVE_SET"); end, OnCancel = function(self) AutoEquip_7fa14bf1c4f9fdb64a455dfd719908d8() end, showAlert = 1, timeout = 0, }; StaticPopupDialogs["SAVE_RESAVE"] = { text = AUTOEQUIP_SAVE_INFO, button1 = YES, button2 = NO, OnAccept = function(self) local name = AutoEquip_4028c7da12ff52455abb865b298ff7e2(AutoEquip_500a8ad122d34cab3e445c13c86044e5) AutoEquip_224246a2aec3ecad61ed8d03e82f9cb2(name,AutoEquip_500a8ad122d34cab3e445c13c86044e5) end, showAlert = 1, timeout = 0, }; function AutoEquip_Toggle(switch) if (switch) then AutoEquip_6781199f633c5d9ede0aa8c0a5a346d0 = true; AutoEquipFrame:Show(); else AutoEquip_6781199f633c5d9ede0aa8c0a5a346d0 = false; AutoEquipFrame:Hide(); end end function AutoEquip_ToggleMode(mode) if (mode == "normal") then AutoEquip_352a74c60685e01427cbef1c647d5199 = false; AutoEquipFrame:SetMovable(false); AutoEquipFrame:SetClampedToScreen(false); AutoEquipFrame:SetParent(PlayerFrame); AutoEquipFrame:SetWidth(120); AutoEquipFrame:SetHeight(23); AutoEquipFrame:EnableMouse(false); AutoEquipFrame:SetHitRectInsets(0, 0, 119, 22); AutoEquipFrame:ClearAllPoints(); AutoEquipFrame:SetPoint("TOPLEFT", "PlayerFrame", "TOPLEFT", 90, -1); AutoEquipFrame:SetFrameLevel(AutoEquipFrame:GetParent():GetFrameLevel()+2); AutoEquipFrameBackground.normal_coords = {0, 0.46484375, 0, 0.171875}; AutoEquipFrameBackground.hilight_coords = {0, 0.46484375, 0, 0.171875}; AutoEquipFrameBackground:SetTexCoord(unpack(AutoEquipFrameBackground.normal_coords)); AutoEquipSaveButton:SetPoint("TOPLEFT", AutoEquipFrame, "TOPLEFT", 6, -2); AutoEquipSetButton5:Hide(); AutoEquipSetButton6:Hide(); AutoEquipSetButton7:Hide(); AutoEquipSetButton8:Hide(); MoveIcons(); elseif (mode == "advance") then AutoEquip_352a74c60685e01427cbef1c647d5199 = true; AutoEquipFrame:SetMovable(true); AutoEquipFrame:SetClampedToScreen(true); AutoEquipFrame:SetParent(UIParent); AutoEquipFrame:SetWidth(240); AutoEquipFrame:SetHeight(30); AutoEquipFrame:EnableMouse(true); AutoEquipFrame:SetHitRectInsets(0, 204, 0, 0); AutoEquipFrame:ClearAllPoints(); AutoEquipFrame:SetPoint("CENTER", "UIParent", "CENTER", 0, 0); AutoEquipFrame:SetFrameLevel(AutoEquipFrame:GetParent():GetFrameLevel()+2) AutoEquipFrameBackground.normal_coords = {0, 0.93359375, 0.1796875, 0.40625}; AutoEquipFrameBackground.hilight_coords = {0, 0.93359375, 0.4140625, 0.640625}; AutoEquipFrameBackground:SetTexCoord(unpack(AutoEquipFrameBackground.normal_coords)); AutoEquipSaveButton:SetPoint("TOPLEFT", AutoEquipFrame, "TOPLEFT", 37, -5); AutoEquipSetButton5:Show(); AutoEquipSetButton6:Show(); AutoEquipSetButton7:Show(); AutoEquipSetButton8:Show(); ResetIcons(); RegisterForSaveFrame(AutoEquipFrame, "AutoEquipFrame"); end end function AutoEquip_EnableAutoHide(switch) if (switch) then AutoEquip_642022feafc2fd091c1bc9b53b20e8d1 = true; AutoEquip_c990e192b1d042b676a4ee0ffff5d729(); else AutoEquip_642022feafc2fd091c1bc9b53b20e8d1 = false; AutoEquipFrame:Show(); end end function AutoEquip_KeyBinding() BigFoot_ShowKeyBindingFrame("HEADER_AUTOEQUIP_TITLE"); end local MerSwitch,havedone,MerDurabilityTooltip local InventorySlots = { "HeadSlot:d", "NeckSlot:n", "ShoulderSlot:d", "BackSlot:n", "ChestSlot:d", "ShirtSlot:n", "TabardSlot:n", "WristSlot:d", "HandsSlot:d", "WaistSlot:d", "LegsSlot:d", "FeetSlot:d", "Finger0Slot:n", "Finger1Slot:n", "Trinket0Slot:n", "Trinket1Slot:n", "MainHandSlot:d", "SecondaryHandSlot:d", }; local function CreateRepairCostFrame() if MerRepairMoneyFrame then return end local moneyFrame = CreateFrame("Frame", "MerRepairMoneyFrame", PaperDollFrame, "SmallMoneyFrameTemplate"); moneyFrame:SetPoint("BOTTOMLEFT", CharacterModelFrame, "BOTTOMLEFT", 5, 20); moneyFrame.title = moneyFrame:CreateFontString(nil, "ARTWORK", "GameFontNormal"); moneyFrame.title:SetPoint("BOTTOMLEFT", moneyFrame, "TOPLEFT", -2, 2); moneyFrame.title:SetText(M_REPAIR_COST); moneyFrame:SetScript("OnShow", function(self) MoneyFrame_SetType(self,"STATIC"); end); end local function CreateInventorySlots(frame) if havedone then return end local s for _, v in pairs(InventorySlots) do s = strsplit(":", v); local button = _G[frame .. s]; count = button.Count; count:ClearAllPoints(); count:SetPoint("BOTTOMRIGHT", button, "BOTTOMRIGHT", 2, 3); end havedone = true; end local function DisplayInventoryInfo() MerDurabilityTooltip = MerDurabilityTooltip or CreateFrame("GameTooltip", "MerDurabilityTooltip", UIParent, "GameTooltipTemplate"); local button, count, c, m, p, hasItem, itemLink, repairCos, totalCos, suffix, scan; for i, v in ipairs(InventorySlots) do suffix, scan = strsplit(":", v,2); button = _G["Character" .. suffix]; count = button.Count; count:Hide(); MerDurabilityTooltip:SetOwner(UIParent, "ANCHOR_NONE"); MerDurabilityTooltip:ClearLines(); hasItem, _, repairCos = MerDurabilityTooltip:SetInventoryItem("player", button:GetID()); itemLink = select(2, MerDurabilityTooltip:GetItem()); if MerSwitch and hasItem and itemLink then if (scan == "d") then totalCos = (totalCos or 0) + repairCos; c, m = GetInventoryItemDurability(button:GetID()); if (c and m and m > 0) then p = c / m; count:SetFormattedText("%d%%", floor(p * 100)); if (p > 0.5) then count:SetTextColor(0.133, 0.78, 0.133); elseif (p > 0.25) then count:SetTextColor(1, 0.7 ,0.2); else count:SetTextColor(1, 0, 0); end count:Show() end end end end if not MerSwitch or totalCos == 0 then MerRepairMoneyFrame:Hide() else MoneyFrame_Update("MerRepairMoneyFrame", totalCos or 0); MerRepairMoneyFrame:Show() end end local function UpdateInventoryItemDurability() local button, count, c, m, p, suffix, scan; for i, v in ipairs(InventorySlots) do suffix,scan = strsplit(":", v,2); button = _G["Character" .. suffix]; count = button.Count; count:Hide() if MerSwitch then if (scan == "d") then c, m = GetInventoryItemDurability(button:GetID()); if (c and m and m > 0) then p = c / m; count:SetFormattedText("%d%%", floor(p * 100)); if (p > 0.5) then count:SetTextColor(0.133, 0.78, 0.133); elseif (p > 0.25) then count:SetTextColor(1, 0.7 ,0.2); else count:SetTextColor(1, 0, 0); end count:Show() end end end end end hooksecurefunc("PaperDollItemSlotButton_OnEvent",function(self, event, ...) if ( event == "PLAYER_EQUIPMENT_CHANGED") then local arg1, arg2 = ...; if ( self:GetID() == arg1 ) then if MerSwitch then DisplayInventoryInfo() end end elseif event == "BAG_UPDATE_COOLDOWN" then UpdateInventoryItemDurability() end end); PaperDollFrame:HookScript("OnShow", DisplayInventoryInfo); function MerInspect_ToogleD(switch) if (switch) then MerSwitch = true; CreateRepairCostFrame(); CreateInventorySlots("Character") else MerSwitch = false; end DisplayInventoryInfo() end 
